<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!--Create Department form-->
        <record id="view_department_form_inherit" model="ir.ui.view">
            <field name="name">hr.department.form.inherit</field>
            <field name="model">hr.department</field>
            <field name="inherit_id" ref="hr.view_department_form"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='name']" position="after">
                    <field name="business_unit_id" invisible="0"/>
                </xpath>
                <xpath expr="//field[@name='parent_id']" position="attributes">
                    <attribute name="domain">[('business_unit_id', '=', business_unit_id)]</attribute>
                    <attribute name="context">{'default_business_unit_id':business_unit_id}</attribute>
                </xpath>
                <xpath expr="//group" position="after">
                    <separator string="Job Titles"/>
                    <field name="job_title_ids" nolable="1" readonly="0"/>
                </xpath>
            </field>
        </record>

        <!--Department tree-->
        <record id="view_department_tree_inherit" model="ir.ui.view">
            <field name="name">hr.department.tree.inherit</field>
            <field name="model">hr.department</field>
            <field name="inherit_id" ref="hr.view_department_tree"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='parent_id']" position="replace"/>
                <xpath expr="//field[@name='display_name']" position="after">
                    <field name="business_unit_id"/>
                    <field name="parent_id"/>
                </xpath>
                <xpath expr="//field[@name='display_name']" position="attributes">
                    <attribute name="string">Department Name</attribute>
                </xpath>
            </field>
        </record>

        <!--Create a Job Position popup form-->
        <record id="hr_job_simple_form_inherit" model="ir.ui.view">
            <field name="name">hr.job.simple.form.inherit</field>
            <field name="model">hr.job</field>
            <field name="inherit_id" ref="hr_recruitment.hr_job_simple_form"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='name']" position="before">
                    <field name="business_unit_id" class="oe_inline" invisible="0" options="{'no_create':True,'no_open':True}"/>
                    <field name="department_id" class="oe_inline"
                           domain="[('business_unit_id', '=', business_unit_id)]"/>
                    <field name="job_title_id" class="oe_inline" domain="[('department_ids', 'in', department_id)]"
                           context="{'default_department_ids':[(4,department_id)]}" placeholder="e.g. Sales Manager"/>
                    <field name="job_level_id" class="oe_inline" domain="[('job_title_ids', 'in', job_title_id)]"
                           context="{'default_job_title_ids':[(4,job_title_id)]}" placeholder="e.g. Level 1"/>
                </xpath>
                <xpath expr="//field[@name='name']" position="attributes">
                    <attribute name="attrs">{'invisible':True,'required':False}</attribute>
                </xpath>
            </field>
        </record>

        <!--Create a Job Position form-->
        <record id="hr_job_form_inherit" model="ir.ui.view">
            <field name="name">hr.job.form.inherit</field>
            <field name="model">hr.job</field>
            <field name="inherit_id" ref="hr.view_hr_job_form"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='department_id']" position="replace"/>
                <xpath expr="//div[@class='oe_title']" position="replace">
                    <div class="oe_title">
                        <label for="business_unit_id" invisible="0"/>
                        <h3>
                            <field name="business_unit_id" invisible="0"/>
                        </h3>
                        <label for="department_id"/>
                        <h3>
                            <field name="department_id" domain="[('business_unit_id', '=', business_unit_id)]"
                                   context="{'default_business_unit_id':business_unit_id}"/>
                        </h3>
                        <label for="job_title_id"/>
                        <h3>
                            <field name="job_title_id" domain="[('department_ids', '=', department_id)]"
                                   context="{'default_department_ids':[(4,department_id)]}"/>
                        </h3>
                        <label for="job_level_id"/>
                        <h3>
                            <field name="job_level_id" domain="[('job_title_ids', '=', job_title_id)]"
                                   context="{'default_job_title_ids':[(4,job_title_id)]}"/>
                        </h3>
                        <field name="name" attrs="{'invisible':True,'required':False}"/>
                    </div>
                </xpath>
                <xpath expr="//field[@name='user_id']" position="attributes">
                    <attribute name="required">1</attribute>
                </xpath>
                <xpath expr="//field[@name='user_id']" position="after">
                    <field name="other_recruiters_ids" widget="many2many_tags"/>
                </xpath>
            </field>
        </record>

        <record id="view_job_title_form" model="ir.ui.view">
            <field name="name">job.title.form</field>
            <field name="model">job.title</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <group>
                            <field name="department_ids" widget='many2many_tags' readonly="1"/>
                            <field name="name" string="Job Name"/>
                            <field name="job_code" attrs="{'readonly':[('has_application','=',True)]}"/>
                            <separator string="Job Levels"/>
                            <field name="job_level_ids" readonly="0"/>
                            <field name="has_application" invisible="1"/>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="view_job_level_form" model="ir.ui.view">
            <field name="name">job.level.form</field>
            <field name="model">job.level</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <group>
                            <field name="job_title_ids" widget='many2many_tags' readonly="0"/>
                            <field name="name"/>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="view_bu_form" model="ir.ui.view">
            <field name="name">business.unit.form</field>
            <field name="model">business.unit</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <group>
                            <field name="name" string="Business Unit"/>
                            <field name="id" invisible="1"/>
                            <separator string="Departments"/>
                            <field name="job_dep_ids" context="{'default_business_unit_id': id}" nolable="1"
                                   readonly="0"/>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

    </data>
</odoo>