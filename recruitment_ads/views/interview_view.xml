<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="view_calendar_event_interview_form" model="ir.ui.view">
        <field name="name">view_calendar_event_interview_form</field>
        <field name="model">calendar.event</field>
        <field name="type">form</field>
        <field name="priority" eval="1"/>
        <field name="mode">primary</field>
        <field name="inherit_id" ref="calendar.view_calendar_event_form"/>
        <field name="arch" type="xml">
            <form position="attributes">
                <attribute name="string">Interview</attribute>
            </form>
            <label for="name" position="attributes">
                <attribute name="string">Interview Subject</attribute>
            </label>
            <label for="partner_ids" position="attributes">
                <attribute name="string">Interviewers</attribute>
            </label>
            <field name="partner_ids" position="attributes">
                <attribute name="placeholder">Select Interviewers...</attribute>
            </field>
            <field name="partner_ids" position="attributes">
                <attribute name="required">1</attribute>
            </field>
            <field name="partner_ids" position="attributes">
                <attribute name="context">
                    {'display_pos':True,'force_email':True,'orderby':'name','match_name_start':True}
                </attribute>
            </field>
            <field name="partner_ids" position="attributes">
                <attribute name="options">{'no_create_edit': True,'no_create':True}</attribute>
            </field>
            <xpath expr="//div[@class='oe_title']/h2" position="after">
                <label for="extra_followers_ids" string="Followers" class="oe_edit_only"/>
                <h2>
                    <field name="extra_followers_ids" widget="many2many_tags"
                           placeholder="Select followers..."
                           options="{'no_create_edit': True,'no_create':True}"
                           context="{'display_pos':True,'force_email':True,'orderby':'name','match_name_start':True}"
                           class="oe_inline"/>
                </h2>
            </xpath>
            <page name="page_details" position="attributes">
                <attribute name="string">Details</attribute>
            </page>
            <field name="categ_ids" position="replace"/>
            <page name="page_details" position="inside">
                <field name="recurrency" invisible="1"/>
            </page>
            <page name="page_options" position="replace"/>
            <page name="page_invitations" position="replace"/>
            <page name="page_misc" position="replace"/>
            <div class="oe_chatter" position="replace"/>
            <!--page name="page_details" position="after">
                <page string="Chat">

                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="message_ids" widget="mail_thread"/>

                </page>
            </page-->
        </field>
    </record>
    <!--<delete model="ir.ui.view" search="[('id','=',ref('recruitment_ads.view_calendar_event_interview_calender'))]"/>-->
    <record id="view_calendar_event_interview_calender" model="ir.ui.view">
        <field name="name">view_calendar_event_interview_calender</field>
        <field name="model">calendar.event</field>
        <field name="priority" eval="3"/>
        <field name="type">calendar</field>
        <field name="mode">primary</field>
        <field name="arch" type="xml">
            <calendar string="Interview" date_start="start" date_stop="stop" date_delay="duration" all_day="allday"
                      readonly_form_view_id="%(calendar.view_calendar_event_form_popup)d"
                      form_view_id="%(recruitment_ads.view_calendar_event_interview_form)d"
                      event_open_popup="true"
                      event_limit="3"
                      color="partner_id">
                <field name="name"/>
                <field name="partner_ids" write_model="calendar.contacts" write_field="partner_id"
                       avatar_field="image_small"/>
                <field name="is_highlighted" invisible="1"/>
            </calendar>
        </field>
    </record>
    <record id="view_calendar_event_tree_inherit" model="ir.ui.view">
        <field name="name">view_calendar_event_tree_inherit</field>
        <field name="model">calendar.event</field>
        <field name="type">tree</field>
        <field name="inherit_id" ref="calendar.view_calendar_event_tree"/>
        <field name="arch" type="xml">
            <field name="message_needaction" position="after">
                <field name="type" invisible="1"/>
            </field>
        </field>
    </record>
    <delete model="ir.ui.view" search="[('id','=',ref('recruitment_ads.view_calendar_event_tree_interview'))]"/>
    <record id="view_calendar_event_tree_interview" model="ir.ui.view">
        <field name="name">view_calendar_event_tree_interview</field>
        <field name="model">calendar.event</field>
        <field name="type">tree</field>
        <field name="priority" eval="100"/>
        <field name="arch" type="xml">
            <tree create="0" edit="0">
                <field name="job_id"/>
                <field name="name" string="Subject"/>
                <field name="user_id"/>
                <field name="start_datetime"/>
                <field name="start_date"/>
                <field name="display_partners"/>
                <field name="last_stage_activity"/>
                <field name="last_stage_result"/>
                <field name="type" invisible="1"/>
                <field name="state" invisible="1"/>
            </tree>
        </field>
    </record>
    <record id="calendar.action_calendar_event" model="ir.actions.act_window">
        <field name="domain">[('type','=','normal')]</field>
    </record>
    <record id="mail_activity_view_form_popup_inherit" model="ir.ui.view">
        <field name="name">mail_activity_view_form_popup_inherit</field>
        <field name="model">mail.activity</field>
        <field name="inherit_id" ref="mail.mail_activity_view_form_popup"/>
        <field name="arch" type="xml">
            <field name="activity_type_id" position="attributes">
                <attribute name="domain">[('category','!=','interview')]</attribute>
            </field>
        </field>
    </record>
    <act_window
            id="action_interview_calendar_event"
            name="Interviews"
            res_model="calendar.event"
            view_mode="tree"
            domain="[('type','=','interview')]"
            context="{'default_type': 'interview', 'default_duration': 0.5}"
            view_type="form"/>

    <record id="act_window_view_calendar_event_tree" model="ir.actions.act_window.view">
        <field name="sequence" eval="0"/>
        <field name="view_mode">tree</field>
        <field name="view_id" ref="view_calendar_event_tree_interview"/>
        <field name="act_window_id" ref="action_interview_calendar_event"/>
    </record>
    <delete model="ir.actions.act_window.view" search="[('id','=',ref('act_window_view_calendar_event_form'))]"/>
    <menuitem id="menu_interview_calendar"
              name="Interviews"
              parent="hr_recruitment.menu_crm_case_categ0_act_job"
              sequence="21"
              action="action_interview_calendar_event"
              groups="recruitment_ads.group_view_interviews"/>
</odoo>